{% extends "base.html" %}
{% block content %}

<h2>Admin â€” Menu (Restaurant {{ rid }})</h2>

<form method="get" action="{{ url_for('admin_menu') }}">
  <label>Switch restaurant:
    <select name="r" onchange="this.form.submit()">
      {% for r in restaurants %}
        <option value="{{ r.id }}" {% if r.id==rid %}selected{% endif %}>{{ r.name }}</option>
      {% endfor %}
    </select>
  </label>
</form>

<h3 style="margin-top:1rem">Add item</h3>
<form method="post" action="{{ url_for('admin_menu_add') }}">
  <label>Name
    <input name="name" required>
  </label>
  <label>Description
    <input name="description" placeholder="optional">
  </label>
  <label>Price (VND)
    <input name="price" inputmode="decimal" placeholder="95000" required>
  </label>
  <label>Restaurant
    <select name="restaurant_id">
      {% for r in restaurants %}
        <option value="{{ r.id }}" {% if r.id==rid %}selected{% endif %}>{{ r.name }}</option>
      {% endfor %}
    </select>
  </label>
  <button type="submit">Add</button>
</form>

<h3 style="margin-top:1rem">Items</h3>
<table>
  <thead>
    <tr>
      <th>ID</th><th>Name</th><th>Price</th><th>Description</th><th>Restaurant</th><th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for it in items %}
      <tr>
        <td>{{ it.id }}</td>
        <td>{{ it.name }}</td>
        <td>{{ "%.0f"|format(it.price) }}</td>
        <td>{{ it.description or "" }}</td>
        <td>{{ it.restaurant_id }}</td>
        <td>
          <a href="{{ url_for('admin_menu_edit', item_id=it.id) }}">Edit</a>
          <form method="post"
                action="{{ url_for('admin_menu_delete', item_id=it.id) }}"
                style="display:inline"
                onsubmit="return confirm('Delete item #{{ it.id }}?')">
            <button type="submit">Delete</button>
          </form>
        </td>
      </tr>
    {% else %}
      <tr><td colspan="6">No items</td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}