<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Create Order</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<header class="appbar">
  <h1><a href="/order">Create Order</a></h1>
  <nav>
    <a href="/menu">Menu</a>
    <a href="/admin">Admin</a>
    <a href="/customers">Customers</a>
  </nav>
</header>

<main class="container">
  {% if message %}
    <div class="alert success">{{ message }}</div>
  {% endif %}

  <section class="card">
    <h2>Customer Info</h2>
    <form method="post" action="/order" class="grid-2">
      <input type="hidden" name="action" value="set_customer">
      <label>
        Name:
        <input name="customer_name" placeholder="e.g. Ali Khan (default Walk-in)" value="{{ customer_name or '' }}">
      </label>
      <label>
        Phone:
        <input name="customer_phone" placeholder="e.g. 0300-1234567" value="{{ customer_phone or '' }}">
      </label>
      <div class="row end">
        <button type="submit">Save Customer</button>
      </div>
    </form>
  </section>

  <section class="card">
    <h2>Add Items</h2>
    <form method="post" action="/order" class="row wrap">
      <input type="hidden" name="action" value="add_line">
      <label>
        Item:
        <select name="item_id" required>
          {% for it in items %}
            <option value="{{ it.id }}">{{ it.name }} â€” {{ it.price }} VND</option>
          {% endfor %}
        </select>
      </label>
      <label>
        Qty:
        <input type="number" min="1" step="1" name="qty" value="1" required>
      </label>
      <button type="submit">Add</button>
    </form>

    <table class="table">
      <thead>
        <tr>
          <th>#</th><th>Item</th><th>Qty</th><th>Price each</th><th>Line total</th>
        </tr>
      </thead>
      <tbody>
        {% if cart and cart|length > 0 %}
          {% for ln in cart %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ ln.name }}</td>
              <td>{{ ln.qty }}</td>
              <td>{{ ln.price }}</td>
              <td>{{ ln.qty * ln.price }}</td>
            </tr>
          {% endfor %}
        {% else %}
          <tr><td colspan="5" class="muted">No items yet</td></tr>
        {% endif %}
      </tbody>
      <tfoot>
        <tr>
          <td colspan="4" class="right"><strong>Total:</strong></td>
          <td><strong>{{ total or 0 }} VND</strong></td>
        </tr>
      </tfoot>
    </table>

    <form method="post" action="/order" class="row">
      <input type="hidden" name="action" value="submit_order">
      <button type="submit" class="primary">Submit Order</button>
    </form>
  </section>
</main>
</body>
</html>